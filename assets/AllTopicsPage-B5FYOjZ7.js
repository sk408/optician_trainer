import{j as e,B as m,T as p,D as M,b as _,c as R,d as ee,e as q,a as te,L as ie,r as u,C as G,a7 as se,P as re,m as o}from"./index-QFGerhOC.js";import{S as le}from"./StudyProgressService-benNJ-HH.js";import{C as ae,a as ne}from"./CardContent-DpczXj_v.js";import{C as U}from"./CheckCircle-BXX9UtKP.js";import{S as oe}from"./Stack-zvMEDtjB.js";import{C as v}from"./Chip-DUjRLUQz.js";import{T as ce}from"./AccessTime-B2I7-Gcj.js";import{L as de}from"./LinearProgress-TKkTc7Uu.js";import{S as pe}from"./School-DO6AY2Mq.js";import{C as me}from"./CardActions-z0ShQhwI.js";import{T as ue}from"./TextField-r1vpHhn7.js";import{I as xe,S as he}from"./Search-D8-K0YyL.js";import{G as a}from"./Grid-Bur4XjUl.js";import{F as B}from"./FormControl-BXNDODOn.js";import{I as P,S as A}from"./Select-BvoMVEEt.js";import{T as fe,a as y}from"./Tabs-DKEWm0ej.js";import"./v4-C6aID195.js";const g=({topic:l,progress:r,onStart:n,isCurrent:c=!1})=>{const f=()=>{n&&n(l.id)},d=(r==null?void 0:r.completed)||!1,x=(r==null?void 0:r.timeSpentMinutes)&&r.timeSpentMinutes>0;return e.jsxs(ae,{variant:c?"elevation":"outlined",elevation:c?3:0,sx:{height:"100%",display:"flex",flexDirection:"column",borderLeft:c||d?"5px solid":"none",borderLeftColor:c?"primary.main":d?"success.main":"transparent",opacity:d?.85:1},children:[e.jsxs(ne,{sx:{flexGrow:1},children:[e.jsxs(m,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsx(p,{variant:"h6",component:"div",gutterBottom:!0,children:l.title}),d&&e.jsx(U,{color:"success",fontSize:"small"})]}),e.jsxs(oe,{direction:"row",spacing:1,sx:{mb:2},children:[e.jsx(v,{label:l.examType,size:"small",color:l.examType==="ABO"?"primary":"secondary",variant:"outlined"}),e.jsx(v,{icon:e.jsx(ce,{fontSize:"small"}),label:`${l.estimatedTimeMinutes} min`,size:"small"}),e.jsx(v,{label:l.difficulty,size:"small",color:"default",variant:"outlined"})]}),e.jsx(p,{variant:"body2",color:"text.secondary",paragraph:!0,children:l.description}),x&&e.jsxs(m,{sx:{mt:2,mb:2},children:[e.jsx(p,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Progress"}),e.jsx(de,{variant:"determinate",value:d?100:Math.min(((r==null?void 0:r.timeSpentMinutes)||0)/l.estimatedTimeMinutes*100,90),color:d?"success":"primary",sx:{height:6,borderRadius:3}}),e.jsxs(p,{variant:"caption",sx:{display:"block",mt:.5},children:[(r==null?void 0:r.timeSpentMinutes)||0," min spent",(r==null?void 0:r.quizScore)!==void 0&&` â€¢ Quiz score: ${r.quizScore}%`]})]}),e.jsx(M,{sx:{my:2}}),e.jsx(p,{variant:"subtitle2",gutterBottom:!0,children:"Key Points:"}),e.jsxs(_,{dense:!0,disablePadding:!0,children:[l.keyPoints.slice(0,3).map((I,j)=>e.jsxs(R,{disablePadding:!0,sx:{py:.5},children:[e.jsx(ee,{sx:{minWidth:30},children:e.jsx(pe,{fontSize:"small",color:"primary"})}),e.jsx(q,{primary:I})]},j)),l.keyPoints.length>3&&e.jsx(R,{disablePadding:!0,sx:{py:.5},children:e.jsx(q,{primary:`+${l.keyPoints.length-3} more points...`,primaryTypographyProps:{variant:"caption",color:"text.secondary"}})})]})]}),l.relatedTopics.length>0&&e.jsx(m,{sx:{px:2,pb:1},children:e.jsxs(p,{variant:"caption",color:"text.secondary",children:["Related topics: ",l.relatedTopics.join(", ")]})}),e.jsx(me,{children:e.jsx(te,{fullWidth:!0,variant:"contained",component:ie,to:`/study/${l.id}`,color:d?"success":"primary",onClick:f,startIcon:d?e.jsx(U,{}):void 0,children:d?"Review":x?"Continue":"Start"})})]})};function b(l){const{children:r,value:n,index:c,...f}=l;return e.jsx("div",{role:"tabpanel",hidden:n!==c,id:`filter-tabpanel-${c}`,"aria-labelledby":`filter-tab-${c}`,...f,children:n===c&&e.jsx(m,{sx:{py:3},children:r})})}const ze=()=>{const[l,r]=u.useState(!0),[n,c]=u.useState(0),[f,d]=u.useState([]),[x,I]=u.useState(""),[j,V]=u.useState("all"),[L,H]=u.useState("all"),[h,K]=u.useState("recommended");u.useEffect(()=>{(async()=>{r(!0);const i=le.getAllTopicsWithProgress();d(i),r(!1)})()},[]);const Q=(t,i)=>{c(i)},Z=t=>{I(t.target.value)},J=t=>{V(t.target.value)},X=t=>{H(t.target.value)},Y=t=>{K(t.target.value)},T=f.filter(t=>{const i=t.topic.title.toLowerCase().includes(x.toLowerCase())||t.topic.description.toLowerCase().includes(x.toLowerCase()),s=j==="all"||t.topic.difficulty===j,C=L==="all"||t.topic.examType===L;return i&&s&&C}),S=[...T].sort((t,i)=>{var s,C,w,k,z,D,O,W,$,F;if(h==="recommended")return(s=t.progress)!=null&&s.completed&&!((C=i.progress)!=null&&C.completed)?1:!((w=t.progress)!=null&&w.completed)&&((k=i.progress)!=null&&k.completed)?-1:t.topic.title.localeCompare(i.topic.title);if(h==="title")return t.topic.title.localeCompare(i.topic.title);if(h==="difficulty"){const N={beginner:1,intermediate:2,advanced:3};return N[t.topic.difficulty]-N[i.topic.difficulty]}else{if(h==="time")return t.topic.estimatedTimeMinutes-i.topic.estimatedTimeMinutes;if(h==="progress")return(z=t.progress)!=null&&z.completed&&!((D=i.progress)!=null&&D.completed)?-1:!((O=t.progress)!=null&&O.completed)&&((W=i.progress)!=null&&W.completed)?1:((($=i.progress)==null?void 0:$.timeSpentMinutes)||0)-(((F=t.progress)==null?void 0:F.timeSpentMinutes)||0)}return 0}),E=(t,i)=>S.filter(s=>s.topic.sectionId===t&&s.topic.examType===i);return l?e.jsx(G,{maxWidth:!1,children:e.jsx(m,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",children:e.jsx(se,{})})}):e.jsxs(G,{maxWidth:!1,sx:{py:4},children:[e.jsx(p,{variant:"h4",gutterBottom:!0,children:"ABO-NCLE Study Topics"}),e.jsx(p,{variant:"subtitle1",color:"text.secondary",paragraph:!0,children:"Browse all topics or filter to find specific content for your exam preparation."}),e.jsxs(re,{sx:{p:3,mb:4},children:[e.jsx(m,{mb:3,children:e.jsx(ue,{fullWidth:!0,placeholder:"Search topics...",value:x,onChange:Z,InputProps:{startAdornment:e.jsx(xe,{position:"start",children:e.jsx(he,{})})}})}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsxs(B,{fullWidth:!0,children:[e.jsx(P,{id:"difficulty-label",children:"Difficulty"}),e.jsxs(A,{labelId:"difficulty-label",id:"difficulty-select",value:j,label:"Difficulty",onChange:J,children:[e.jsx(o,{value:"all",children:"All Levels"}),e.jsx(o,{value:"beginner",children:"Beginner"}),e.jsx(o,{value:"intermediate",children:"Intermediate"}),e.jsx(o,{value:"advanced",children:"Advanced"})]})]})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsxs(B,{fullWidth:!0,children:[e.jsx(P,{id:"exam-type-label",children:"Exam Type"}),e.jsxs(A,{labelId:"exam-type-label",id:"exam-type-select",value:L,label:"Exam Type",onChange:X,children:[e.jsx(o,{value:"all",children:"All Exams"}),e.jsx(o,{value:"ABO",children:"ABO"}),e.jsx(o,{value:"NCLE",children:"NCLE"})]})]})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsxs(B,{fullWidth:!0,children:[e.jsx(P,{id:"sort-label",children:"Sort By"}),e.jsxs(A,{labelId:"sort-label",id:"sort-select",value:h,label:"Sort By",onChange:Y,children:[e.jsx(o,{value:"recommended",children:"Recommended"}),e.jsx(o,{value:"title",children:"Title (A-Z)"}),e.jsx(o,{value:"difficulty",children:"Difficulty (Easiest First)"}),e.jsx(o,{value:"time",children:"Time (Shortest First)"}),e.jsx(o,{value:"progress",children:"Progress"})]})]})})]}),e.jsxs(m,{mt:3,display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(p,{variant:"subtitle1",children:[T.length," topics found"]}),e.jsxs(m,{children:[e.jsx(v,{label:`${T.filter(t=>{var i;return(i=t.progress)==null?void 0:i.completed}).length} Completed`,color:"success",variant:"outlined",sx:{mr:1}}),e.jsx(v,{label:`${T.filter(t=>{var i,s;return!((i=t.progress)!=null&&i.completed)&&((s=t.progress)==null?void 0:s.timeSpentMinutes)&&t.progress.timeSpentMinutes>0}).length} In Progress`,color:"warning",variant:"outlined"})]})]})]}),e.jsxs(fe,{value:n,onChange:Q,"aria-label":"topic filter tabs",sx:{mb:2},variant:"scrollable",scrollButtons:"auto",children:[e.jsx(y,{label:"All Topics",id:"filter-tab-0","aria-controls":"filter-tabpanel-0"}),e.jsx(y,{label:"ABO Topics",id:"filter-tab-1","aria-controls":"filter-tabpanel-1"}),e.jsx(y,{label:"NCLE Topics",id:"filter-tab-2","aria-controls":"filter-tabpanel-2"}),e.jsx(y,{label:"Completed",id:"filter-tab-3","aria-controls":"filter-tabpanel-3"}),e.jsx(y,{label:"In Progress",id:"filter-tab-4","aria-controls":"filter-tabpanel-4"})]}),e.jsx(b,{value:n,index:0,children:e.jsx(a,{container:!0,spacing:3,children:S.map(t=>e.jsx(a,{item:!0,xs:12,sm:6,md:4,children:e.jsx(g,{topic:t.topic,progress:t.progress})},t.topic.id))})}),e.jsx(b,{value:n,index:1,children:["optical-theory","dispensing","lens-applications","regulations","measurements","tools-equipment"].map(t=>{const i=E(t,"ABO");return i.length===0?null:e.jsxs(m,{mb:4,children:[e.jsx(p,{variant:"h5",gutterBottom:!0,children:t.split("-").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ")}),e.jsx(M,{sx:{mb:2}}),e.jsx(a,{container:!0,spacing:3,children:i.map(s=>e.jsx(a,{item:!0,xs:12,sm:6,md:4,children:e.jsx(g,{topic:s.topic,progress:s.progress})},s.topic.id))})]},t)})}),e.jsx(b,{value:n,index:2,children:["pre-fitting","diagnostic-fitting","cl-materials","patient-education","follow-up-care","regulatory"].map(t=>{const i=E(t,"NCLE");return i.length===0?null:e.jsxs(m,{mb:4,children:[e.jsx(p,{variant:"h5",gutterBottom:!0,children:t.split("-").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" ")}),e.jsx(M,{sx:{mb:2}}),e.jsx(a,{container:!0,spacing:3,children:i.map(s=>e.jsx(a,{item:!0,xs:12,sm:6,md:4,children:e.jsx(g,{topic:s.topic,progress:s.progress})},s.topic.id))})]},t)})}),e.jsx(b,{value:n,index:3,children:e.jsx(a,{container:!0,spacing:3,children:S.filter(t=>{var i;return(i=t.progress)==null?void 0:i.completed}).map(t=>e.jsx(a,{item:!0,xs:12,sm:6,md:4,children:e.jsx(g,{topic:t.topic,progress:t.progress})},t.topic.id))})}),e.jsx(b,{value:n,index:4,children:e.jsx(a,{container:!0,spacing:3,children:S.filter(t=>{var i,s;return!((i=t.progress)!=null&&i.completed)&&((s=t.progress)==null?void 0:s.timeSpentMinutes)&&t.progress.timeSpentMinutes>0}).map(t=>e.jsx(a,{item:!0,xs:12,sm:6,md:4,children:e.jsx(g,{topic:t.topic,progress:t.progress})},t.topic.id))})})]})};export{ze as default};
